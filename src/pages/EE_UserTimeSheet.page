<apex:page showHeader="false" sidebar="false" standardController="User_TimeSheet__c" extensions="EE_CTRL_UserTimeSheetExtension" standardStylesheets="false">
    <apex:includeScript value="{!$Resource.jQuery321}"/>
    <apex:stylesheet value="{!URLFOR($Resource.bootstrap, 'bootstrap/css/bootstrap.css')}"/>
    <apex:includeScript value="{!URLFOR($Resource.bootstrap, 'bootstrap/js/bootstrap.js')}"/>

    <style>
			.headerSize{
				font-size: 18px;
			}

			.aligment{
				padding-top: 7px;
			}
			.infoTable{
				height: 40px;
			}

			.infoTable td{
				border-style: solid;
				border-width: 2px;
				border-color: #8484e1;
				background-color:  #c2c2f0;
				width:10%;
				text-align: center;
			}

			.detailLabel{
			    font-weight: bold;
			    margin-top: 6px;
			}

			.selectMargin{
			    margin:5px;
			}

			.buttonPanel{
			    clear:both;
			    text-align:center;
			    margin-bottom:5px;
			}
		</style>
        <script>
			let OVERDUE_STATUS = 'Overdue'
			 $(function() {
 				if('{!userTimeSheet.status__c}' == OVERDUE_STATUS){
 					saveOverdue(); 									
 				}
 				let elem = findElement(null,'.message.errorM3');
 				replaceStandardSalsforceMessages();
 			 });
		</script>
    <c:EE_JS_SfdcMessageReplace/>
	<apex:outputPanel id="mainPanel" layout="block" styleClass="container" >
		<apex:outputPanel layout="block" style="text-align: center">
			<h1>TimeSheet</h1>
		</apex:outputPanel>		
		<apex:outputPanel layout="block" style="margin-top: 10px;margin-bottom: 10px">
			<apex:outputPanel layout="block">
				<apex:panelGrid columns="8" styleClass="infoTable" headerClass="headerSize" >								
					<apex:outputLabel value="From Date" styleClass="detailLabel"/>
					<apex:outputField value="{!timeSheet.StartDay__c}"/>
					<apex:outputLabel value="To Date" styleClass="detailLabel"/>
					<apex:outputField value="{!timeSheet.EndDate__c}"/>
					<apex:outputLabel value="Name" styleClass="detailLabel"/>
					<apex:outputText value="{!$User.FirstName} {!$User.LastName}"/>
					<apex:outputLabel value="Email" styleClass="detailLabel"/>
					<apex:outputText value="{!$User.Email}"/>
				</apex:panelGrid>
			</apex:outputPanel>			
		</apex:outputPanel>		
		<apex:pageMessages />
		<apex:outputPanel layout="block">
			<apex:form >
				<apex:outputPanel layout="block" style="float:left">
						<apex:panelgrid columns="2" styleClass="table" headerClass="headerSize" style="width:350px;">
							<apex:facet name="header">Week days</apex:facet>							
							<apex:outputLabel value="{!$Label.Monday}" styleClass="aligment"/>
							<apex:selectList value="{!userTimeSheet.Monday_Hours__c}" size="1" styleClass="form-control selectMargin"
                                             disabled="{!mondayDisabled}">
								<apex:selectOptions value="{!items}"/>
							</apex:selectList>
							<apex:outputLabel value="{!$Label.Tuesday}" styleClass="aligment"/>
							<apex:selectList value="{!userTimeSheet.Tuesday_Hours__c}" size="1" styleClass="form-control selectMargin"
                                             disabled="{!tuesdayDisabled}">
								<apex:selectOptions value="{!items}"/>
							</apex:selectList>
							<apex:outputLabel value="{!$Label.Wednesday}" styleClass="aligment"/>
							<apex:selectList value="{!userTimeSheet.Wednesday_Hours__c}" size="1" styleClass="form-control selectMargin"
                                             disabled="{!wednesdayDisabled}">
								<apex:selectOptions value="{!items}"/>
							</apex:selectList>
							<apex:outputLabel value="{!$Label.Thursday}" styleClass="aligment"/> 
							<apex:selectList value="{!userTimeSheet.Thursday_Hours__c}" size="1" styleClass="form-control selectMargin"
                                             disabled="{!thursdayDisabled}">
								<apex:selectOptions value="{!items}"/>
							</apex:selectList>
							<apex:outputLabel value="{!$Label.Friday}" styleClass="aligment"/>
							<apex:selectList value="{!userTimeSheet.Friday_Hours__c}" size="1" styleClass="form-control selectMargin"
                                             disabled="{!fridayDisabled}">
								<apex:selectOptions value="{!items}"/>
							</apex:selectList>
							<apex:outputLabel value="{!$Label.Saturday}" styleClass="aligment"/>
							<apex:selectList value="{!userTimeSheet.Saturday_Hours__c}" size="1" styleClass="form-control selectMargin"
                                             disabled="{!saturdayDisabled}">
								<apex:selectOptions value="{!items}"/>
							</apex:selectList>
							<apex:outputLabel value="{!$Label.Sunday}" styleClass="aligment"/>
							<apex:selectList value="{!userTimeSheet.Sunday_Hours__c}" size="1" styleClass="form-control selectMargin"
                                             disabled="{!sundayDisabled}">
								<apex:selectOptions value="{!items}"/>
							</apex:selectList>
						</apex:panelgrid>							
				</apex:outputPanel>				
				<apex:outputPanel layout="block" id="infoPanel" style="float:right">
					<apex:outputPanel layout="block">
						<apex:panelGrid columns="2" styleclass="table"  headerClass="headerSize">
							<apex:facet name="header">Other</apex:facet>						
							<apex:outputLabel value="Status"/>
							<apex:outputField value="{!userTimeSheet.Status__c}" styleClass="form-control"/>
							<apex:outputLabel value="Overhours allowed"/>
							<apex:outputField value="{!userTimeSheet.Overhours_Allowed__c}" styleClass="form-control"/>
							<apex:outputLabel value="Current Project" styleClass="aligment"/>
							<apex:outputText value="{!BLANKVALUE(project.Name,'No project')}" styleClass="form-control"/>
						</apex:panelGrid>	
					</apex:outputPanel>
					<apex:outputPanel layout="block">
						<apex:panelGrid columns="1" styleclass="table">
							<apex:outputLabel value="Comment"/>
							<apex:inputField value="{!userTimeSheet.User_Comment__c}" style="width:200px;height:200px" styleClass="form-control"/>
						</apex:panelGrid>	
					</apex:outputPanel>					
				</apex:outputPanel>
				<apex:outputPanel layout="block" styleClass="buttonPanel">
				 	<apex:commandButton style="margin-right: 5px;" styleClass="btn btn-success" action="{!saveUserTimeSheet}" value="Save"
                                        disabled="{!disableSaveButton}" rerender="mainPanel" status="status" oncomplete="replaceStandardSalsforceMessages()"/>
				 	<apex:commandButton style="margin-right: 5px;" styleClass="btn btn-success" action="{!sentForApproval}" value="Sent to Approval" disabled="{!userTimeSheet.Status__c != 'Submitted'}"
                                        status="status"  rerender="mainPanel" oncomplete="replaceStandardSalsforceMessages()"/>
				 	<apex:commandButton styleClass="btn" action="{!cancel}" value="Cancel"/>
				</apex:outputPanel>
				<apex:actionFunction action="{!saveOverdueUserTimeSheet}" name="saveOverdue" rerender="js-panel" oncomplete="redirectAfterOverdueSave()"/>
				<c:EE_ActionStatusComponent/>
       			 <apex:outputPanel id="js-panel">				
					<script type="text/javascript">
					 function redirectAfterOverdueSave(){ 				 	
					 	if({!redirectAfterOverdueCheck}){
					 		var newLocation = '/apex/EE_UserTimeSheet?id='+('{!userTimeSheet.ID}' == '' ? '':'{!userTimeSheet.ID}');
					 		window.location.replace(newLocation);
					 	}
	 				 }
					</script>
				</apex:outputPanel>
			</apex:form>
		</apex:outputPanel>
	</apex:outputPanel>
</apex:page>